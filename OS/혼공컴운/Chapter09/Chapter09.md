# Chapter 09 운영체제 시작하기 

### OS란?

* 실행할 프로그램에 필요한 자원을 할당하고, 프로그램이 올바르게 실행되도록 돕는 특별한 프로그램
  * 자원?
    * CPU, 메모리, HDD, SDD 등을 총괄하는 물리적 기계장치
* OS -> 프로그램이기 때문에 메모리에 적재되어야한다.
  * OS는 일반 프로그램과 달리 특별하기에 '커널영역'에 적재된다. 
  * 응용 프로그램(일반적 프로그램)을 '메모리'에 적재하는 역할을 수행
    * 프로그램이 실행되려면 CPU가 필요한데, 어떤 프로그램(프로세스)가 얼마나 CPU를 점유할지 시간을 
      정하는 것 역할 역시 'OS'의 몫
  * 응용프로그램과 하드웨어 사이에서 자원을 할당하고 제어하는 역할 수행
    * Ex) 워드프로세스, 메모장이 동시에 프린터를 호출한다면 순서와 흐름제어 역할 수행
  * OS의 역할별로 기능이 다르다.
    * 특정 부분은 CPU제어, 특정부분은 메모리 관리, 특정부분은 하드 디스크 등을 관리한다.

### 커널영역

* 자원에 접근하고 조작하는 기능, 프로그램이 올바르고 안전하게 실행되게 하는 기능
  * -> '커널'이 담당한다. 

* OS가 제공하는 서비스 중 커널에 포함되지 않는 영역또한 존재한다. 
  * UI(사용자 인터페이스)
    * Ex) CLI, GUI

### 이중모드와 시스템호출(System Call)

* OS는 응용프로그램이 하드웨어 자원(CPU, 메모리, 하드디스크 등)에 마음대로 접근하지 못하도로 제어

  * 오직 OS를 통해서 해당 자원에 접근하도록 자원을 보호
  * CF) 응용프로그램이 OS에 도움을 요청한다는 말은 즉, '운영체제 코드를 실행하려고 한다.'는 말의 의미
  * Ex) 응용프로그램이 하드디스크에 접근하는 기능을 수행하려면, OS는 커널 영역 내의 하드 디스크에 데이터를 저장하는 코드를
    실행하여, 응용프로그램의 작업을 대신 수행한다. 

* 이러한 문지기로서의 역할은 '이중모드(Dual Mode)'로서 가능하다. 

  * CPU가 명령어를 실행하는 모드를 크게 '사용자모드', '커널 모드'로 구분하는 방식

* <b>사용자모드</b>

  * 운영체제 서비스를 제공받을 수 없는 실행모드
  * 커널영역의 코드를 실행불가. 
  * 사용자 모드로 실행되는 일반 응용플그램은 자원에 접근 불가

* ##### 커널모드

  * 운영체제 서비스를 받을 수 있는 실행모드
  * OS는 커널모드로 실행되기 때문에 자원에 접근 가능

* ##### 시스템 콜

  * OS의 서비스를 제공받기 위해(즉 자원에 접근하기 위해) OS에 커널모드로 전환하기 위해 요청하는 것
  * 소프트웨어 인터럽트

### 프로세스 관리

* CPU는 한 번에 하나의 프로세스만 실행할 수 있으므로 프로세스들을 조금씩 번갈아가면서 실행한다. 

  

### CF) 가상머신과 이중모드의 발전

* 현대 CPU는 커널모드, 사용자모드 이상의 것을 지원

* ##### 가상머신

  * 하나의 서버 내에 또 다른 운영체제를 지닌 서버를 만들 수 있다. 
  * 물리적 하드웨어 시스템 위에 구축되어 자체 CPU,메모리, 네트워크 인터페이스 및 스토리지를 갖추고 가상 컴퓨터 시스템으로 작동하는 가상환경
  * CF) 생성된 VM -> Guest Server / VM들이 구동되는 서버 -> Host Server
  * Ex) 본인의 Local PC 내의 Ubuntu Vm을 설치한다면 내 본래의 서버(Mac)이 Host Server이고 Ubuntu가 Guest Server인셈

* VM의 생성과 작동을 위해선 '하이퍼바이저'가 필요

  * 하이퍼바이저는 가상화 계층(Virtualization Layer)을 구현해주는 소프트웨어
  * 즉, 아래의 그림과 같이 하드웨어와 가상머신 사이의 인터페이스 역할을한다. 

<img width="788" alt="image" src="https://github.com/daewon-ko/Book/assets/105340285/a7493a7b-e075-48c6-a373-d320fa8d7de0">
